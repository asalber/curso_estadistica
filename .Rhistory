data <- rep(income, counts)
hist(data, main="", breaks=breaks, xaxt="n", xlab="", ylab="Frecuencia relativa", col=blueceulight, prob=T)
curve(dnorm(x, mean=mean(data), sd=sd(data)), col="red", lwd=2, add=TRUE, yaxt="n")
dev.off()
# Distribuciones normales
# Author: Alfredo Sánchez Alberca (asalber@ceu.es)
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
# Colors
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
redceulight <- rgb(238,50,36,255,maxColorValue = 255, alpha = 125) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
# Pesos hombres
tikz(file="img/descriptiva/ejemplo_distribucion_peso.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(123)
data <- rnorm(10000, mean = 88, sd = 12)
breaks <- seq(40, 140, 2)
hist(data, main="Peso de hombres", breaks=breaks, xaxt = "n", xlab = "Peso (kg)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Estatura mujeres
tikz(file="img/descriptiva/ejemplo_distribucion_altura_mujeres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Altura hombres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_hombres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data <- rnorm(10000, mean = 175, sd = 9)
min(data)
max(data)
breaks <- seq(140, 210, 2)
hist(data, main="Estatura de hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Women and men heights
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_mujeres_hombres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data.women <- rnorm(10000, mean = 164, sd = 8)
data.men <- rnorm(10000, mean = 175, sd = 9)
breaks <- seq(130, 210, 2)
hist(data.women, main="Estaturas por sexo", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
hist(data.men, breaks=breaks, xaxt = "n", col = redceulight, prob = T, add = T)
polygon(density(data.women), border = "blue")
polygon(density(data.men), border = "red")
axis(side = 1, at = breaks, labels = breaks)
legend("topright", legend=c("Mujeres", "Hombres"), fill=c(blueceulight, redceulight), cex=0.8)
dev.off()
# Heights
tikz(file="img/descriptiva/ejemplo_distribucion_estaturas.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data.women <- rnorm(10000, mean = 164, sd = 8)
data.men <- rnorm(10000, mean = 175, sd = 9)
data <- c(data.women, data.men)
breaks <- seq(130, 210, 2)
hist(data, main="Estaturas de mujeres y hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Cholesterol
tikz(file="img/descriptiva/ejemplo_distribucion_colesterol.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(123)
data <- rnorm(10000, mean = 192, sd = 18)
breaks <- seq(120, 265, 5)
hist(data, main="Nivel de colesterol", breaks=breaks, xaxt = "n", xlab = "Colesterol (mg/dl)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Exam
tikz(file="img/descriptiva/ejemplo_distribucion_notas.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(123)
data <- rnorm(1000, mean = 5.5, sd = 1.4)
breaks <- seq(0, 10, 0.5)
hist(data[data<=10], main="Notas de Estadística", breaks=breaks, xaxt = "n", xlab = "Nota", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# bell shaped distribution
tikz(file="img/descriptiva/campana_gauss.tex", width=7, height=5)
par(cex.lab=1.2)
x <- seq(-3.3, 3.3, by=0.05)
plot(x, dnorm(x, mean=0, sd=1), ylim=c(0,0.45), main="Campana de Gauss", type="l", col=color2, lwd=3, axes = F, xlab = "", ylab = "")
dev.off()
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/statistics_manual")
library(tikzDevice)
# Colors
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
tikz(file="img/descriptive/right_skewed_distribution_example.tex", width=7, height=5)
par(cex.lab=1.2)
income <- seq(2500,207500,5000)/1000
counts <- c(4235, 4071, 6324, 6470, 6765, 6222, 6354, 5743, 5203, 5002, 5078, 4140, 4367, 3733, 3683, 3650, 3354, 2893, 2850, 2452, 2792, 2232, 2158, 1748, 1987, 1675, 1474, 1380, 1220, 1111, 1313, 1017, 993, 761, 822, 700, 677, 536, 561, 431, 314, 215)
breaks <- seq(0,210000,5000)/1000
data <- rep(income, counts)
hist(data, main="USA household income dristribution", breaks=breaks, xaxt="n", xlab="Yearly income (thousand dollars)", ylab="Relative frequency", col=blueceulight, prob=T)
axis(side=1, at=breaks, labels=breaks, las=2)
dev.off()
# Estatura mujeres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_mujeres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
# Colors
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
redceulight <- rgb(238,50,36,255,maxColorValue = 255, alpha = 125) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
# Estatura mujeres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_mujeres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
# Colors
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
# Distribución bimodal
tikz(file="img/descriptiva/ejemplo_distribucion_bimodal.tex", width=7, height=5)
par(cex.lab=1.2)
counts <- c(35, 20, 18, 48, 75, 67, 43, 22, 14, 21, 23, 47, 63, 44, 25, 15)
breaks <- seq(8.5,23.5,1)
data <- rep(breaks, counts)
breaks <- seq(8,24)
hist(data, main="Distribución de la hora de llegada a un restaurante",  xlab="Hora de llegada", ylab="Frecuencia relativa", breaks = breaks, xaxt="n", col=blueceulight, prob=T)
axis(side=1, at=breaks, labels=breaks)
dev.off()
# Estatura hombres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_hombres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data <- rnorm(10000, mean = 175, sd = 9)
breaks <- seq(140, 210, 2)
hist(data, main="Estatura de hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
set.seed(1234)
data.women <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data.women, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
par(cex.lab=1.2)
set.seed(1234)
data.women <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data.women, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data.women), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
par(cex.lab=1.2)
set.seed(1234)
data.men <- rnorm(10000, mean = 175, sd = 9)
breaks <- seq(140, 210, 2)
hist(data.men, main="Estatura de hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data.men), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
par(cex.lab=1.2)
breaks <- seq(130, 210, 2)
hist(data.women, main="Estaturas por sexo", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
hist(data.men, breaks=breaks, xaxt = "n", col = redceulight, prob = T, add = T)
polygon(density(data.women), border = "blue")
polygon(density(data.men), border = "red")
axis(side = 1, at = breaks, labels = breaks)
legend("topright", legend=c("Mujeres", "Hombres"), fill=c(blueceulight, redceulight), cex=0.8)
# Estatura mujeres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_mujeres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data.women <- rnorm(10000, mean = 164, sd = 8)
breaks <- seq(130, 200, 2)
hist(data.women, main="Estatura de mujeres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data.women), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Estatura hombres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_hombres.tex", width=7, height=5)
par(cex.lab=1.2)
set.seed(1234)
data.men <- rnorm(10000, mean = 175, sd = 9)
breaks <- seq(140, 210, 2)
hist(data.men, main="Estatura de hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data.men), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# Estatura hombres y mujeres
tikz(file="img/descriptiva/ejemplo_distribucion_estatura_mujeres_hombres.tex", width=7, height=5)
par(cex.lab=1.2)
breaks <- seq(130, 210, 2)
hist(data.women, main="Estaturas por sexo", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
hist(data.men, breaks=breaks, xaxt = "n", col = redceulight, prob = T, add = T)
polygon(density(data.women), border = "blue")
polygon(density(data.men), border = "red")
axis(side = 1, at = breaks, labels = breaks)
legend("topright", legend=c("Mujeres", "Hombres"), fill=c(blueceulight, redceulight), cex=0.8)
dev.off()
# Estaturas
tikz(file="img/descriptiva/ejemplo_distribucion_estaturas.tex", width=7, height=5)
par(cex.lab=1.2)
data <- c(data.women, data.men)
breaks <- seq(130, 210, 2)
hist(data, main="Estaturas de mujeres y hombres", breaks=breaks, xaxt = "n", xlab = "Estatura (cm)", ylab = "Frecuencia relativa", col = blueceulight, prob = T)
polygon(density(data), border = "blue")
axis(side = 1, at = breaks, labels = breaks)
dev.off()
# bell shaped distribution
tikz(file="img/descriptiva/campana_gauss.tex", width=7, height=5)
par(cex.lab=1.2)
x <- seq(-3.3, 3.3, by=0.05)
plot(x, dnorm(x, mean=0, sd=1), ylim=c(0,0.45), main="Campana de Gauss", type="l", col=color2, lwd=3, axes = F, xlab = "", ylab = "")
plot(x, dnorm(x, mean=0, sd=1), ylim=c(0,0.45), main="Campana de Gauss", type="l", col = redceu, lwd=3, axes = F, xlab = "", ylab = "")
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
redceulight <- rgb(238,50,36,255,maxColorValue = 255, alpha = 125) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
par(cex.lab=1.2)
x <- seq(-3.3, 3.3, by = 0.05)
plot(x, dnorm(x, mean=0, sd=1), ylim=c(0,0.45), main="Campana de Gauss", type="l", col = redceu, lwd=3, axes = F, xlab = "", ylab = "")
plot(x, dnorm(x, mean=0, sd=1), ylim=c(0,0.45), main="Campana de Gauss", type="l", col = redceu, lwd=3, axes = F, xlab = "", ylab = "")
par(cex.lab = 1.2)
x <- seq(-3.3, 3.3, by = 0.05)
plot(x, dnorm(x, mean = 0, sd = 1), ylim = c(0,0.45), main = "Campana de Gauss", type = "l", col = redceu, lwd = 3, axes = F, xlab = "", ylab = "")
par(cex.lab = 1.2)
x <- seq(-3.3, 3.3, by = 0.05)
x
plot(x, dnorm(x, mean = 0, sd = 1), ylim = c(0,0.45), main = "Campana de Gauss", type = "l", col = redceu, lwd = 3, axes = F, xlab = "", ylab = "")
par(cex.lab = 1.2)
x <- seq(-3.3, 3.3, by = 0.05)
plot(x, dnorm(x, mean = 0, sd = 1), ylim = c(0,0.45), main = "Campana de Gauss", type = "l", col = redceu, lwd = 3, axes = F, xlab = "", ylab = "")
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
# Colors
blueceu <- rgb(5,161,230,255,maxColorValue = 255) #0099CC
blueceulight <- rgb(137,211,243,255,maxColorValue = 255) #89D3F3
redceu <- rgb(238,50,36,255,maxColorValue = 255) #FF3333
redceulight <- rgb(238,50,36,255,maxColorValue = 255, alpha = 125) #FF3333
greenceu <- rgb(194,205,255,255,maxColorValue = 255) #CCCC33
orangeceu <- rgb(248,131,121,255,maxColorValue = 255)#F88379
purpleceu <- rgb(169,78,145,255,maxColorValue = 255) #996699
greyceu <- rgb(117,117,97,255,maxColorValue = 255) #666666
tikz(file="img/descriptiva/campana_gauss.tex", width=7, height=5)
par(cex.lab = 1.2)
x <- seq(-3.3, 3.3, by = 0.05)
plot(x, dnorm(x, mean = 0, sd = 1), ylim = c(0,0.45), main = "Campana de Gauss", type = "l", col = redceu, lwd = 3, axes = F, xlab = "", ylab = "")
dev.off()
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/statistics_manual")
library(tikzDevice)
library(plyr)
library(plotly)
library(shape)
require(Hmisc)
# Color definition
color1=rgb(5,161,230,max=255)
color2=rgb(238,50,36,max=255)
options(tikzDefaultEngine = "xetex")
set.seed(1234)
hours1 <- runif(50, 0, 9)
score1 <- 0.4 * hours1 + 4 + rnorm(50, mean = 0, sd = 1)
hours2 <- runif(50, 5, 15)
score2 <-  0.2 * hours2 + 1 + rnorm(50, mean = 0, sd = 1)
score <- c(score1, score2)
hours <- c(hours1, hours2)
tikz(file="img/regression/simpson_paradox_1.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9, 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score ~ hours, col =color1, main="Linear regression of score on hours of study", xlim=c(0,16), ylim=c(0,10), xlab="Weekly hours of study", ylab="Score", pch=16)
model <- lm(score ~ hours)
abline(model, lwd=2)
coeffs <- floor(model$coeff*100)/100
plusorminus <- c("+")
if (coeffs[1] < 0 ) plusorminus <- c("")
text(10, 9, paste("$y=", coeffs[2], "x", plusorminus, coeffs[1], "$"), pos = 4)
text(10, 8.2, paste("$r=", round(cor(hours, score), 2), "$"), pos = 4)
dev.off()
tikz(file="img/regression/simpson_paradox_2.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9 , 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score1 ~ hours1, col =color1, main="Linear regression of score on hours of study", xlim=c(0,16), ylim=c(0,10), xlab="Weekly hours of study", ylab="Score", pch=16)
points(score2 ~ hours2, col =color2, pch=16)
model1 <- lm(score1 ~ hours1)
abline(model1, lwd=2, col = color1)
coeffs1 <- floor(model1$coeff*100)/100
plusorminus <- c("+")
if (coeffs1[1] < 0 ) plusorminus <- c("")
text(0, 8.5, paste("$y=", coeffs1[2], "x", plusorminus, coeffs1[1], "$"), pos = 4)
text(0, 7.7, paste("$r=", round(cor(hours1, score1), 2), "$"), pos = 4)
model2 <- lm(score2 ~ hours2)
abline(model2, lwd=2, col = color2)
coeffs2 <- floor(model2$coeff*100)/100
plusorminus <- c("+")
if (coeffs2[1] < 0 ) plusorminus <- c("")
text(10, 0.8, paste("$y=", coeffs2[2], "x", plusorminus, coeffs2[1], "$"), pos = 4)
text(10, 0, paste("$r=", round(cor(hours2, score2), 2), "$"), pos = 4)
legend("top", legend=c("Good students", "Bad students"), fill=c(color1, color2), cex = 0.8, horiz = T)
dev.off()
setwd("/media/disk/ceu/docencia/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
library(plyr)
library(plotly)
library(shape)
require(Hmisc)
# Color definition
color1=rgb(5,161,230,max=255)
color2=rgb(238,50,36,max=255)
options(tikzDefaultEngine = "xetex")
set.seed(1234)
hours1 <- runif(50, 0, 9)
score1 <- 0.4 * hours1 + 4 + rnorm(50, mean = 0, sd = 1)
hours2 <- runif(50, 5, 15)
score2 <-  0.2 * hours2 + 1 + rnorm(50, mean = 0, sd = 1)
score <- c(score1, score2)
hours <- c(hours1, hours2)
tikz(file="img/regresion/paradoja_simpson_1.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9, 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score ~ hours, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
model <- lm(score ~ hours)
abline(model, lwd=2)
coeffs <- floor(model$coeff*100)/100
plusorminus <- c("+")
if (coeffs[1] < 0 ) plusorminus <- c("")
text(10, 9, paste("$y=", coeffs[2], "x", plusorminus, coeffs[1], "$"), pos = 4)
text(10, 8.2, paste("$r=", round(cor(hours, score), 2), "$"), pos = 4)
dev.off()
tikz(file="img/regresion/paradoja_simpson_2.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9 , 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score1 ~ hours1, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
points(score2 ~ hours2, col =color2, pch=16)
model1 <- lm(score1 ~ hours1)
abline(model1, lwd=2, col = color1)
coeffs1 <- floor(model1$coeff*100)/100
plusorminus <- c("+")
if (coeffs1[1] < 0 ) plusorminus <- c("")
text(0, 8.5, paste("$y=", coeffs1[2], "x", plusorminus, coeffs1[1], "$"), pos = 4)
text(0, 7.7, paste("$r=", round(cor(hours1, score1), 2), "$"), pos = 4)
model2 <- lm(score2 ~ hours2)
abline(model2, lwd=2, col = color2)
coeffs2 <- floor(model2$coeff*100)/100
plusorminus <- c("+")
if (coeffs2[1] < 0 ) plusorminus <- c("")
text(10, 0.8, paste("$y=", coeffs2[2], "x", plusorminus, coeffs2[1], "$"), pos = 4)
text(10, 0, paste("$r=", round(cor(hours2, score2), 2), "$"), pos = 4)
legend("top", legend=c("Buenos estudiantes", "Malos estudiantes"), fill=c(color1, color2), cex = 0.8, horiz = T)
dev.off()
hours1 <- runif(50, 0, 9)
score1 <- 0.4 * hours1 + 4 + rnorm(50, mean = 0, sd = 1)
hours2 <- runif(50, 5, 15)
score2 <-  0.2 * hours2 + 1 + rnorm(50, mean = 0, sd = 1)
score <- c(score1, score2)
hours <- c(hours1, hours2)
tikz(file="img/regresion/paradoja_simpson_1.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9, 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score ~ hours, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
model <- lm(score ~ hours)
abline(model, lwd=2)
coeffs <- floor(model$coeff*100)/100
plusorminus <- c("+")
if (coeffs[1] < 0 ) plusorminus <- c("")
text(10, 9, paste("$y=", coeffs[2], "x", plusorminus, coeffs[1], "$"), pos = 4)
text(10, 8.2, paste("$r=", round(cor(hours, score), 2), "$"), pos = 4)
par(mar = c(2.9, 2.9 , 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score1 ~ hours1, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
points(score2 ~ hours2, col =color2, pch=16)
model1 <- lm(score1 ~ hours1)
abline(model1, lwd=2, col = color1)
coeffs1 <- floor(model1$coeff*100)/100
plusorminus <- c("+")
if (coeffs1[1] < 0 ) plusorminus <- c("")
text(0, 8.5, paste("$y=", coeffs1[2], "x", plusorminus, coeffs1[1], "$"), pos = 4)
text(0, 7.7, paste("$r=", round(cor(hours1, score1), 2), "$"), pos = 4)
model2 <- lm(score2 ~ hours2)
abline(model2, lwd=2, col = color2)
coeffs2 <- floor(model2$coeff*100)/100
plusorminus <- c("+")
if (coeffs2[1] < 0 ) plusorminus <- c("")
text(10, 0.8, paste("$y=", coeffs2[2], "x", plusorminus, coeffs2[1], "$"), pos = 4)
text(10, 0, paste("$r=", round(cor(hours2, score2), 2), "$"), pos = 4)
legend("top", legend=c("Buenos estudiantes", "Malos estudiantes"), fill=c(color1, color2), cex = 0.8, horiz = T)
# Paradoja de Simpson
set.seed(1234)
hours1 <- runif(50, 0, 9)
score1 <- 0.4 * hours1 + 4 + rnorm(50, mean = 0, sd = 1)
hours2 <- runif(50, 5, 15)
score2 <-  0.2 * hours2 + 1 + rnorm(50, mean = 0, sd = 1)
score <- c(score1, score2)
hours <- c(hours1, hours2)
tikz(file="img/regresion/paradoja_simpson_1.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9, 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score ~ hours, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
model <- lm(score ~ hours)
abline(model, lwd=2)
coeffs <- floor(model$coeff*100)/100
plusorminus <- c("+")
if (coeffs[1] < 0 ) plusorminus <- c("")
text(10, 9, paste("$y=", coeffs[2], "x", plusorminus, coeffs[1], "$"), pos = 4)
text(10, 8.2, paste("$r=", round(cor(hours, score), 2), "$"), pos = 4)
dev.off()
tikz(file="img/regresion/paradoja_simpson_2.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9 , 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score1 ~ hours1, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
points(score2 ~ hours2, col =color2, pch=16)
model1 <- lm(score1 ~ hours1)
abline(model1, lwd=2, col = color1)
coeffs1 <- floor(model1$coeff*100)/100
plusorminus <- c("+")
if (coeffs1[1] < 0 ) plusorminus <- c("")
text(0, 8.5, paste("$y=", coeffs1[2], "x", plusorminus, coeffs1[1], "$"), pos = 4)
text(0, 7.7, paste("$r=", round(cor(hours1, score1), 2), "$"), pos = 4)
model2 <- lm(score2 ~ hours2)
abline(model2, lwd=2, col = color2)
coeffs2 <- floor(model2$coeff*100)/100
plusorminus <- c("+")
if (coeffs2[1] < 0 ) plusorminus <- c("")
text(10, 0.8, paste("$y=", coeffs2[2], "x", plusorminus, coeffs2[1], "$"), pos = 4)
text(10, 0, paste("$r=", round(cor(hours2, score2), 2), "$"), pos = 4)
legend("top", legend=c("Buenos estudiantes", "Malos estudiantes"), fill=c(color1, color2), cex = 0.8, horiz = T)
dev.off()
setwd("/media/disk/ceu/docencia/materiales/estadistica/presentaciones/manual_estadistica")
setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/manual_estadistica")
library(tikzDevice)
library(plyr)
library(plotly)
library(shape)
require(Hmisc)
# Color definition
color1=rgb(5,161,230,max=255)
color2=rgb(238,50,36,max=255)
options(tikzDefaultEngine = "xetex")
# Paradoja de Simpson
set.seed(1234)
hours1 <- runif(50, 0, 9)
score1 <- 0.4 * hours1 + 4 + rnorm(50, mean = 0, sd = 1)
hours2 <- runif(50, 5, 15)
score2 <-  0.2 * hours2 + 1 + rnorm(50, mean = 0, sd = 1)
score <- c(score1, score2)
hours <- c(hours1, hours2)
tikz(file="img/regresion/paradoja_simpson_1.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9, 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score ~ hours, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
model <- lm(score ~ hours)
abline(model, lwd=2)
coeffs <- floor(model$coeff*100)/100
plusorminus <- c("+")
if (coeffs[1] < 0 ) plusorminus <- c("")
text(10, 9, paste("$y=", coeffs[2], "x", plusorminus, coeffs[1], "$"), pos = 4)
text(10, 8.2, paste("$r=", round(cor(hours, score), 2), "$"), pos = 4)
dev.off()
tikz(file="img/regresion/paradoja_simpson_2.tex", width=4.5, height=3.3)
par(mar = c(2.9, 2.9 , 2, 1), mgp = c(1.8, 0.6, 0), cex.lab = 1, cex.axis = 0.8, las = 1, tck = -0.02)
plot(score1 ~ hours1, col =color1, main="Regresión lineal de la nota sobre las horas de estudio", xlim=c(0,16), ylim=c(0,10), xlab="Horas de estudio semanales", ylab="Nota", pch=16)
points(score2 ~ hours2, col =color2, pch=16)
model1 <- lm(score1 ~ hours1)
abline(model1, lwd=2, col = color1)
coeffs1 <- floor(model1$coeff*100)/100
plusorminus <- c("+")
if (coeffs1[1] < 0 ) plusorminus <- c("")
text(0, 8.5, paste("$y=", coeffs1[2], "x", plusorminus, coeffs1[1], "$"), pos = 4)
text(0, 7.7, paste("$r=", round(cor(hours1, score1), 2), "$"), pos = 4)
model2 <- lm(score2 ~ hours2)
abline(model2, lwd=2, col = color2)
coeffs2 <- floor(model2$coeff*100)/100
plusorminus <- c("+")
if (coeffs2[1] < 0 ) plusorminus <- c("")
text(10, 0.8, paste("$y=", coeffs2[2], "x", plusorminus, coeffs2[1], "$"), pos = 4)
text(10, 0, paste("$r=", round(cor(hours2, score2), 2), "$"), pos = 4)
legend("top", legend=c("Buenos estudiantes", "Malos estudiantes"), fill=c(color1, color2), cex = 0.8, horiz = T)
dev.off()
